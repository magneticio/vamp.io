<!DOCTYPE html>




 <html class="no-js"> 
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
  <title>Securing Ingress Services in Istio with Let’s Encrypt on Kubernetes | Vamp </title>
  <meta name="generator" content="Hugo 0.52" />

  
  <meta name="description" content="Vamp gives you all the tools to release, control and optimize your containerised apps on cloud native platforms.">
  
  <link rel="canonical" href="https://vamp.io/blog/securing-ingress-services-in-istio-with-lets-encrypt-on-kubernetes/">
  
  <meta name="author" content="magnetic.io">
  

  
  <meta property='og:title' content='Securing Ingress Services in Istio with Let’s Encrypt on Kubernetes | Vamp '>
  

  <meta property="og:image" content=' https://cdn-images-1.medium.com/max/720/1*rclb9okYbeFN-jJmgbT3bw.jpeg'>
  <meta property="og:description" content="

This is the third post in our series describing our experiences in adopting Istio for traffic routing on Kubernetes.
For more details on what we are trying to achieve with Vamp Lamia and why we choose Istio, please refer to our
first post and second post." />
  <meta property="og:url" content="https://vamp.io/blog/securing-ingress-services-in-istio-with-lets-encrypt-on-kubernetes/">
  <meta property="og:type" content="article" />
  
  <meta name="apple-mobile-web-app-title" content="Vamp | Automation and Controls for Enterprise Devops">
  


  

  <meta property='twitter:card' content='summary'>
  <meta property='twitter:title' content='Securing Ingress Services in Istio with Let’s Encrypt on Kubernetes | Vamp.io '>
  <meta property="twitter:description" content="

This is the third post in our series describing our experiences in adopting Istio for traffic routing on Kubernetes.
For more details on what we are trying to achieve with Vamp Lamia and why we choose Istio, please refer to our
first post and second post." />
  <meta property="twitter:image" content=' https://cdn-images-1.medium.com/max/720/1*rclb9okYbeFN-jJmgbT3bw.jpeg'>



  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="icon" type="image/x-icon" href="https://vamp.io/images/favicon.png?v=1.0">
  <style>
    @font-face {
      font-family: 'Icon';
      src: url('/fonts/icon.eot?52m981');
      src: url('/fonts/icon.eot?#iefix52m981')
      format('embedded-opentype'),
      url('/fonts/icon.woff?52m981')
      format('woff'),
      url('/fonts/icon.ttf?52m981')
      format('truetype'),
      url('/fonts/icon.svg?52m981#icon')
      format('svg');
      font-weight: normal;
      font-style: normal;
    }
  </style>

  

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <link type="text/css" rel="stylesheet" href="//unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />

  

  <link rel="stylesheet" href="https://vamp.io/css/dist/style.min-24d00513.css">


  

  <style>.async-hide { opacity: 0 !important} </style>
  <script>
    if (location.host === 'www.vamp.io' || location.host === 'vamp.io') {

      (function (a, s, y, n, c, h, i, d, e) {
        s.className += ' ' + y;
        h.start = 1 * new Date;
        h.end = i = function () {
          s.className = s.className.replace(RegExp(' ?' + y), '')
        };
        (a[n] = a[n] || []).hide = h;
        setTimeout(function () {
          i();
          h.end = null
        }, c);
        h.timeout = c;
      })(window, document.documentElement, 'async-hide', 'dataLayer', 4000,
        {'GTM-TN6W53W': true});
    }
  </script>
  <script>
    document.addEventListener("DOMContentLoaded", function(event) {
      if (location.host === 'www.vamp.io' || location.host === 'vamp.io') {
        (function (i, s, o, g, r, a, m) {
          i['GoogleAnalyticsObject'] = r;
          i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
          }, i[r].l = 1 * new Date();
          a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
          a.async = 1;
          a.src = g;
          m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-59948816-1', 'auto');
        ga('require', 'GTM-TN6W53W');
        ga('send', 'pageview');
      }
    })
  </script>
  
  <script>
    if (location.host === 'www.vamp.io' || location.host === 'vamp.io') {
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
          new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-K55QZJQ');
    }
  </script>
  

  

</head>
<body class="palette-primary-pink palette-accent-pink">

<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K55QZJQ"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>



<div class="landing-page">
  
<nav aria-label="Header" id="header" class="navbar navbar-light">
  <div class="container">
    <div class="left">
      <a href="https://vamp.io/">
        <div id="logo" class="logo"></div>
      </a>
    </div>

    <div class="right">
      <div class="navbar-items" id="navbar-items">
        <a href="https://vamp.io/product/" data-parenturl="/product/" class="navbar-item top-nav-product-top" data-target="webuiPopover0">Product <i class="ml-2 fa fa-angle-down"></i></a>
        <a href="https://blog.vamp.io/" target="_blank" data-parenturl="/blog/" class="navbar-item">Blog</a>
        <a href="https://vamp.io/news/" data-parenturl="/news/" class="navbar-item">News</a>
        <a href="https://vamp.io/documentation/" data-parenturl="/documentation/" class="navbar-item top-nav-developers-top" data-target="webuiPopover1">Resources <i class="ml-2 fa fa-angle-down"></i></a>
        <a href="https://vamp.io/support/" data-parenturl="/support/" class="navbar-item">Support</a>
        <a href="https://vamp.io/pricing/" data-parenturl="/pricing/" class="navbar-item">Pricing</a>
      </div>
      <div id="productPopover" style="display: none">
  <div class="popover-menu-body">
    <a href="https://vamp.io/product/" class="popover-menu-item">Features
      <i class="fa fa-caret-right"></i>
    </a>
    <a href="https://vamp.io/product/use-cases/overview" class="popover-menu-item">Use cases
      <i class="fa fa-caret-right"></i>
    </a>
    <a href="https://vamp.io/product/vamp-compared-to/" class="popover-menu-item">Vamp compared to…
      <i class="fa fa-caret-right"></i>
    </a>
  </div>
</div>

      <div id="developersPopover" style="display: none">
  <div class="popover-menu-body popover-menu-body-wide">
    <a href="https://vamp.io/events" class="popover-menu-item">Events
      <i class="fa fa-caret-right"></i>
    </a>
    <a href="https://vamp.io/documentation/" class="popover-menu-item">Documentation
      <i class="fa fa-caret-right"></i>
    </a>
    <a href="https://vamp.io/documentation/installation/" class="popover-menu-item">Installation
      <i class="fa fa-caret-right"></i>
    </a>
    <a href="https://vamp.io/documentation/api/api-reference/" class="popover-menu-item">API Reference
      <i class="fa fa-caret-right"></i>
    </a>
    <a href="https://vamp.io/documentation/cli/using-the-cli/" class="popover-menu-item">CLI Reference
      <i class="fa fa-caret-right"></i>
    </a>
    <div class="popover-menu-header">By Platform</div>
    <a href="https://vamp.io/documentation/installation/kubernetes/" class="popover-menu-item">
      <img src="https://vamp.io/img/vendor/kubernetes_small.png" alt="kubernetes">
      Kubernetes</a>

    <a href="https://vamp.io/documentation/installation/dcos/" class="popover-menu-item">
      <img src="https://vamp.io/img/vendor/dcos_small.png" alt="dcos">

      DCOS</a>
  </div>
</div>

      <div class="search" style="display: none;">
        <i class="fa fa-search"></i>
        <input type="search" placeholder="search the docs..." class="search-input" autofocus="autofocus">
      </div>
    </div>
  </div>

</nav>

<nav aria-label="Header" id="mobile-header">
  <a href="https://vamp.io/" class="logo">
    <img id="logo" class="logo" src="https://vamp.io/img/005-vamp/Logo/logo-long-colour.svg" alt="">
  </a>
  <div class="right">
    <div class="hamburger">
      <i class="fa fa-lg fa-bars" aria-hidden="true"></i>
    </div>
  </div>

</nav>

<ul id="mobile-menu">
  
  
  
  

    <li>
      <a href="https://vamp.io/product/" data-url="/product/">Product</a>
      
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      
    </li>
    <ul>
      
        <li>
          <a href="https://vamp.io/product/">Features</a>
          
        </li>
        <ul class="mobile-menu-list" data-parenturl="/product/">
          
        </ul>
      
        <li>
          <a href="https://vamp.io/product/use-cases/overview">Use cases</a>
          
            <i class="fa fa-chevron-right" aria-hidden="true"></i>
          
        </li>
        <ul class="mobile-menu-list" data-parenturl="/product/use-cases/overview">
          
            
              <li>
                <a href="https://vamp.io/product/use-cases/overview/" data-url="/product/use-cases/overview/">Overview </a>
              </li>
            
          
            
              <li>
                <a href="https://vamp.io/product/use-cases/create-responsive-website/" data-url="/product/use-cases/create-responsive-website/">Create a responsive website </a>
              </li>
            
          
            
              <li>
                <a href="https://vamp.io/product/use-cases/resolve-incompatibilities-after-upgrade/" data-url="/product/use-cases/resolve-incompatibilities-after-upgrade/">Resolve incompatibilities </a>
              </li>
            
          
            
              <li>
                <a href="https://vamp.io/product/use-cases/modernise-architecture/" data-url="/product/use-cases/modernise-architecture/">Modernising your architecture </a>
              </li>
            
          
            
              <li>
                <a href="https://vamp.io/product/use-cases/refactor-monolithic-to-microsystems/" data-url="/product/use-cases/refactor-monolithic-to-microsystems/">Refactor to microservices </a>
              </li>
            
          
            
              <li>
                <a href="https://vamp.io/product/use-cases/simulate-and-test-scaling-behaviour/" data-url="/product/use-cases/simulate-and-test-scaling-behaviour/">Simulate and test scaling behaviour </a>
              </li>
            
          
            
              <li>
                <a href="https://vamp.io/product/use-cases/self-healing-and-self-optimising/" data-url="/product/use-cases/self-healing-and-self-optimising/">Self-healing and self-optimising </a>
              </li>
            
          
            
              <li>
                <a href="https://vamp.io/product/use-cases/service-discovery/" data-url="/product/use-cases/service-discovery/">Service discovery </a>
              </li>
            
          
        </ul>
      
        <li>
          <a href="https://vamp.io/product/enterprise-edition/">Vamp Enterprise 1.0</a>
          
        </li>
        <ul class="mobile-menu-list" data-parenturl="/product/enterprise-edition/">
          
        </ul>
      
        <li>
          <a href="https://vamp.io/product/vamp-compared-to/proxies-and-load-balancers/">Vamp compared to...</a>
          
            <i class="fa fa-chevron-right" aria-hidden="true"></i>
          
        </li>
        <ul class="mobile-menu-list" data-parenturl="/product/vamp-compared-to/proxies-and-load-balancers/">
          
            
              <li>
                <a href="https://vamp.io/product/vamp-compared-to/proxies-and-load-balancers/" data-url="/product/vamp-compared-to/proxies-and-load-balancers/">Proxies and load balancers </a>
              </li>
            
          
            
              <li>
                <a href="https://vamp.io/product/vamp-compared-to/paas-and-container-systems/" data-url="/product/vamp-compared-to/paas-and-container-systems/">PaaS and container systems </a>
              </li>
            
          
            
              <li>
                <a href="https://vamp.io/product/vamp-compared-to/frameworks-and-tools/" data-url="/product/vamp-compared-to/frameworks-and-tools/">Frameworks and tools </a>
              </li>
            
          
        </ul>
      
    </ul>

  

    <li>
      <a href="https://vamp.io/documentation/" data-url="/documentation/">Documentation</a>
      
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      
    </li>
    <ul>
      
        <li>
          <a href="https://vamp.io/documentation/how-vamp-works/">How Vamp works</a>
          
            <i class="fa fa-chevron-right" aria-hidden="true"></i>
          
        </li>
        <ul class="mobile-menu-list" data-parenturl="/documentation/how-vamp-works/">
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/how-vamp-works/v1.0.0/concepts-and-components/" data-url="/documentation/how-vamp-works/v1.0.0/concepts-and-components/">Concepts and components </a>
                </li>
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/how-vamp-works/v1.0.0/deployment-models/" data-url="/documentation/how-vamp-works/v1.0.0/deployment-models/">Deployment Models </a>
                </li>
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/how-vamp-works/v1.0.0/requirements/" data-url="/documentation/how-vamp-works/v1.0.0/requirements/">Requirements </a>
                </li>
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/how-vamp-works/v1.0.0/vamp-and-kubernetes/" data-url="/documentation/how-vamp-works/v1.0.0/vamp-and-kubernetes/">Vamp and Kubernetes </a>
                </li>
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/how-vamp-works/v1.0.0/events-and-metrics/" data-url="/documentation/how-vamp-works/v1.0.0/events-and-metrics/">Events and metrics </a>
                </li>
              
            
          
            
              
            
          
        </ul>
      
        <li>
          <a href="https://vamp.io/documentation/installation/overview">Installation</a>
          
            <i class="fa fa-chevron-right" aria-hidden="true"></i>
          
        </li>
        <ul class="mobile-menu-list" data-parenturl="/documentation/installation/overview">
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/installation/v1.0.0/overview/" data-url="/documentation/installation/v1.0.0/overview/">Overview </a>
                </li>
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/installation/v1.0.0/kubernetes/" data-url="/documentation/installation/v1.0.0/kubernetes/">Kubernetes Quickstart </a>
                </li>
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/installation/v1.0.0/dcos/" data-url="/documentation/installation/v1.0.0/dcos/">DC/OS Quickstart </a>
                </li>
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
        </ul>
      
        <li>
          <a href="https://vamp.io/documentation/tutorials/">Tutorials</a>
          
            <i class="fa fa-chevron-right" aria-hidden="true"></i>
          
        </li>
        <ul class="mobile-menu-list" data-parenturl="/documentation/tutorials/">
          
            
              <li>
                <a href="https://vamp.io/documentation/tutorials/" data-url="/documentation/tutorials/">Overview </a>
              </li>
            
          
            
              <li>
                <a href="https://vamp.io/documentation/tutorials/deploy-your-first-blueprint/" data-url="/documentation/tutorials/deploy-your-first-blueprint/">1. Deploy your first blueprint </a>
              </li>
            
          
            
              <li>
                <a href="https://vamp.io/documentation/tutorials/run-a-canary-release/" data-url="/documentation/tutorials/run-a-canary-release/">2. Run a canary release </a>
              </li>
            
          
            
              <li>
                <a href="https://vamp.io/documentation/tutorials/split-a-monolith/" data-url="/documentation/tutorials/split-a-monolith/">3. Split a monolith </a>
              </li>
            
          
            
              <li>
                <a href="https://vamp.io/documentation/tutorials/merge-and-delete/" data-url="/documentation/tutorials/merge-and-delete/">4. Merge and delete </a>
              </li>
            
          
            
              <li>
                <a href="https://vamp.io/documentation/tutorials/smarter-releasing-on-kubernetes/" data-url="/documentation/tutorials/smarter-releasing-on-kubernetes/">5. Smarter releasing on Kubernetes </a>
              </li>
            
          
        </ul>
      
        <li>
          <a href="https://vamp.io/documentation/using-vamp/">Using Vamp</a>
          
            <i class="fa fa-chevron-right" aria-hidden="true"></i>
          
        </li>
        <ul class="mobile-menu-list" data-parenturl="/documentation/using-vamp/">
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/using-vamp/v1.0.0/artifacts/" data-url="/documentation/using-vamp/v1.0.0/artifacts/">Artifacts </a>
                </li>
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/using-vamp/v1.0.0/deployments/" data-url="/documentation/using-vamp/v1.0.0/deployments/">Deployments </a>
                </li>
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/using-vamp/v1.0.0/gateways/" data-url="/documentation/using-vamp/v1.0.0/gateways/">Gateways </a>
                </li>
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/using-vamp/v1.0.0/workflows/" data-url="/documentation/using-vamp/v1.0.0/workflows/">Workflows </a>
                </li>
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/using-vamp/v1.0.0/blueprints/" data-url="/documentation/using-vamp/v1.0.0/blueprints/">Blueprints </a>
                </li>
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/using-vamp/v1.0.0/breeds/" data-url="/documentation/using-vamp/v1.0.0/breeds/">Breeds </a>
                </li>
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/using-vamp/v1.0.0/conditions/" data-url="/documentation/using-vamp/v1.0.0/conditions/">Conditions </a>
                </li>
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/using-vamp/v1.0.0/dialects/" data-url="/documentation/using-vamp/v1.0.0/dialects/">Dialects </a>
                </li>
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/using-vamp/v1.0.0/environment-variables/" data-url="/documentation/using-vamp/v1.0.0/environment-variables/">Environment variables </a>
                </li>
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/using-vamp/v1.0.0/escalations/" data-url="/documentation/using-vamp/v1.0.0/escalations/">Escalations </a>
                </li>
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/using-vamp/v1.0.0/events/" data-url="/documentation/using-vamp/v1.0.0/events/">Events </a>
                </li>
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/using-vamp/v1.0.0/health/" data-url="/documentation/using-vamp/v1.0.0/health/">Health checks </a>
                </li>
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/using-vamp/v1.0.0/references/" data-url="/documentation/using-vamp/v1.0.0/references/">Referencing artifacts </a>
                </li>
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/using-vamp/v1.0.0/reverse-proxy/" data-url="/documentation/using-vamp/v1.0.0/reverse-proxy/">Reverse proxy </a>
                </li>
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/using-vamp/v1.0.0/service-discovery/" data-url="/documentation/using-vamp/v1.0.0/service-discovery/">Service discovery </a>
                </li>
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/using-vamp/v1.0.0/sla/" data-url="/documentation/using-vamp/v1.0.0/sla/">SLA (Service Level Agreement) </a>
                </li>
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/using-vamp/v1.0.0/sticky-sessions/" data-url="/documentation/using-vamp/v1.0.0/sticky-sessions/">Sticky Sessions </a>
                </li>
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/using-vamp/v1.0.0/virtual-hosts/" data-url="/documentation/using-vamp/v1.0.0/virtual-hosts/">Virtual Hosts </a>
                </li>
              
            
          
        </ul>
      
        <li>
          <a href="https://vamp.io/documentation/configure">Configure</a>
          
            <i class="fa fa-chevron-right" aria-hidden="true"></i>
          
        </li>
        <ul class="mobile-menu-list" data-parenturl="/documentation/configure">
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/configure/v1.0.0/configure-tenant/" data-url="/documentation/configure/v1.0.0/configure-tenant/">Create a Tenant </a>
                </li>
              
            
          
            
              
                <li>
                  <a href="https://vamp.io/documentation/configure/v1.0.0/configure-database/" data-url="/documentation/configure/v1.0.0/configure-database/">Configure MySQL </a>
                </li>
              
            
          
        </ul>
      
        <li>
          <a href="https://vamp.io/documentation/api/api-reference">API documentation</a>
          
            <i class="fa fa-chevron-right" aria-hidden="true"></i>
          
        </li>
        <ul class="mobile-menu-list" data-parenturl="/documentation/api/api-reference">
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
        </ul>
      
        <li>
          <a href="https://vamp.io/documentation/cli/using-the-cli/">CLI documentation</a>
          
            <i class="fa fa-chevron-right" aria-hidden="true"></i>
          
        </li>
        <ul class="mobile-menu-list" data-parenturl="/documentation/cli/using-the-cli/">
          
            
              <li>
                <a href="https://vamp.io/documentation/cli/using-the-cli/" data-url="/documentation/cli/using-the-cli/">Using the Vamp CLI </a>
              </li>
            
          
        </ul>
      
        <li>
          <a href="https://vamp.io/documentation/troubleshoot">Troubleshoot</a>
          
            <i class="fa fa-chevron-right" aria-hidden="true"></i>
          
        </li>
        <ul class="mobile-menu-list" data-parenturl="/documentation/troubleshoot">
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
            
              
            
          
        </ul>
      
    </ul>

  

    <li>
      <a href="https://vamp.io/support/" data-url="/support/">Support</a>
      
    </li>
    <ul>
      
    </ul>

  

    <li>
      <a href="https://vamp.io/about/" data-url="/about/">About</a>
      
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      
    </li>
    <ul>
      
        <li>
          <a href="https://vamp.io/about/">About us</a>
          
        </li>
        <ul class="mobile-menu-list" data-parenturl="/about/">
          
        </ul>
      
        <li>
          <a href="https://vamp.io/about/dogmas/">Dogmas</a>
          
        </li>
        <ul class="mobile-menu-list" data-parenturl="/about/dogmas/">
          
        </ul>
      
        <li>
          <a href="https://vamp.io/about/contact/">Contact</a>
          
        </li>
        <ul class="mobile-menu-list" data-parenturl="/about/contact/">
          
        </ul>
      
    </ul>

  

    <li>
      <a href="https://vamp.io/news/" data-url="/news/">News</a>
      
    </li>
    <ul>
      
    </ul>

  

    <li>
      <a href="https://blog.vamp.io" data-url="https://blog.vamp.io">Blog</a>
      
    </li>
    <ul>
      
    </ul>

  

    <li>
      <a href="" data-url="">Vamp version comparison</a>
      
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      
    </li>
    <ul>
      
        <li>
          <a href="https://vamp.io/product/vamp-version-comparison/">Vamp Enterprise Edition vs. Vamp Community Edition</a>
          
        </li>
        <ul class="mobile-menu-list" data-parenturl="/product/vamp-version-comparison/">
          
        </ul>
      
    </ul>

  

  <li>
    <a href="https://vamp.io/events/" data-parenturl="/events/"  class="navbar-item">Events</a>
  </li>
  <li>
    <a href="https://vamp.io/pricing/" data-parenturl="/pricing/"  class="navbar-item" >Pricing</a>
  </li>
</ul>


</div>

<div class="page documentation container blog mb-3 pt-5">
  <div class="row">
    <div class="col-sm-12 col-lg-8 offset-lg-2">
      <div class="content blog-content">

        <div class="blog-meta-data">
  <img src="https://vamp.io/img/avatars/berkg.jpg" class="blog-meta-data-avatar" alt="berkg.jpg">
  <div class="blog-meta-data-author-container mb-3 mb-md-0">
    <div class="blog-meta-data-author-name">Berk Gökden</div>
    <div class="blog-meta-data-published-date">August 15, 2018 &middot; 7 min read</div>
  </div>
  <div class="blog-meta-data-tags">
    
    <ul class="badges d-inline ml-md-3">
      
      <li class="badge mb-md-0 mb-2">
        Kubernetes
      </li>
      
      <li class="badge mb-md-0 mb-2">
        Istio
      </li>
      
      <li class="badge mb-md-0 mb-2">
        Microservices
      </li>
      
      <li class="badge mb-md-0 mb-2">
        Security
      </li>
      
    </ul>
    
  </div>
</div>


        <h1 class="blog-header">Securing Ingress Services in Istio with Let’s Encrypt on Kubernetes </h1>

        <div class="markdowned blog-body mb-md-3">
          <p><img src="https://cdn-images-1.medium.com/max/720/1*rclb9okYbeFN-jJmgbT3bw.jpeg" alt="" /></p>

<p>This is the third post in our series describing our experiences in adopting Istio for traffic routing on Kubernetes.
For more details on what we are trying to achieve with Vamp Lamia and why we choose Istio, please refer to our
<a href="https://vamp.io/blog/putting-istio-to-work/">first post</a> and <a href="https://vamp.io/blog/ab-testing-istio/">second post</a>.</p>

<p>In Vamp.io, we are developing Vamp Lamia to help you connect your services to real world easily and that real world requires ssl/tls connection.</p>

<p>Recently many browsers and also other technologies started to enforce having an ssl connection.<a href="https://security.googleblog.com/2018/02/a-secure-web-is-here-to-stay.html"> Google Chrome is warning users for http connections.</a> Android is also <a href="https://android-developers.googleblog.com/2018/04/protecting-users-with-tls-by-default-in.html">expecting secure connections by defaul</a>t now.</p>

<p>In the past, it was hard and expensive process to get certificates from an authority. A general solution was needed. Let’s Encrypt offers a practical solution to the problem of getting SSL/TLS certificates when needed. Here is the official mission of Let’s Encrypt</p>

<blockquote>
<p>Let’s Encrypt is a free, automated, and open certificate authority (CA), run for the public’s benefit. It is a service provided by the <a href="https://letsencrypt.org/isrg/">Internet Security Research Group (ISRG)</a>.
We give people the digital certificates they need in order to enable HTTPS (SSL/TLS) for websites, for free, in the most user-friendly way we can. We do this because we want to create a more secure and privacy-respecting Web.
source: <a href="https://letsencrypt.org/">https://letsencrypt.org/</a></p>
</blockquote>

<p>In Istio, it is possible to <a href="https://istio.io/docs/tasks/traffic-management/secure-ingress/">secure an ingress service by adding certificates to a gateway </a>. But it is a multistep process and certificate authorisation is not documented. To make this process automated, we have added an integration for Let’s Encrypt to Vamp Lamia.</p>

<p>There are two approaches accepted by Let’s Encrypt for certificate authorisation; HTTP and DNS. We decided to implement the DNS method first since it can be used with other TCP protocols like gRPC and also allows wildcard domain certificates.</p>

<p>For DNS authorisation, you still need to have a managed dns service provider. Our development environment is mainly on Google Cloud Platform so we started with integrating Google Cloud DNS, but our system is modularised so it is easy to integrate with other DNS providers such as Amazon Route 53, CloudFlare, etc. As a side note, your DNS provider doesn’t need to be as the same provider as your kubernetes cluster provider. Your cluster can be on AWS and you can still use Google Cloud DNS. Reach out to us if you need some help setting this up.</p>

<p>We integrated Let’s Encrypt into Gateways creation by exposing a secure hostname parameter. With this hostname, we create both a DNS service entry and a certificate authorisation.</p>

<p>This is done in multiple steps, so first we will explain the prerequisites.</p>

<h2 id="prerequisites"><strong>Prerequisites</strong></h2>

<p>The first step is the Zone domain creation, this is needed for name server redirection. This is the initial step and it may need a manual step so I will try to explain it as much as possible.</p>

<p>Some name service providers have fixed name servers but Google Cloud DNS creates a set of 4 name servers per zone. You need to set these name servers as your name servers in your domain provider’s settings. This is a one time operation per domain.</p>

<p>We registered a domain <strong>democluster.net</strong> at <a href="https://www.name.com/">name.com</a> . You can also create a domain at Google Domain but we already had a domain lying around for this blog post. This is an example name server configuration in name.com</p>

<p><img src="https://cdn-images-1.medium.com/max/4676/1*Oc2pbqy5tQel5K8z3oHQ4w.png" alt="" /></p>

<p>Check if your name server configuration is updated. It is cached over the internet and it may take up to 48 hours to actually update. In our case it took around 2 hours.</p>

<p>Note that Google DNS has multiple sets of nameservers so when a zone is created you should check the nameservers and update them.
You can go to Google DNS page and open your zone, there will be the list of name servers under the type NS.</p>

<p><img src="https://cdn-images-1.medium.com/max/4148/1*3a4nMn8og60_4v1pxTcupA.png" alt="Example Zone Record in Google DNS" /><em>Example Zone Record in Google DNS</em></p>

<p>When a Gateway is created, Vamp Lamia will set up the zone record for you and subsequently list the name servers in the UI. Let’s Encrypt authentication requires the name servers to be updated.</p>

<p>Now we can continue with using Vamp Lamia.</p>

<p><strong>Setting up a gateway and service:</strong></p>

<p>To install Vamp Lamia, please follow instructions in our <a href="https://github.com/magneticio/vamp2setup">github</a></p>

<p>For this post, we will use vamp-shop as a deployment, it is included in our package under samples. Vamp Shop is an imaginary e-commerce website, where we test our canary releasing features. We have mentioned it in <a href="https://medium.com/vamp-io/a-b-testing-on-kubernetes-with-istio-0-8-6323efa2b4e2">our A/B testing blog post</a>, we are using nearly the same architecture in this post.
Please run <a href="https://github.com/magneticio/vamp2setup/blob/master/samples/experiment-demo/demo-setup.sh">demo-setup.sh</a> to deploy Vamp Shop to your kubernetes cluster.</p>

<p>Vamp Lamia regularly checks the cluster and installs missing components of Istio and detects new deployments, it is recommended to wait on the “List Virtual Cluster” page until you see the “vamp-demo” namespace appear, when it is available you can edit it.</p>

<p>For this demo you need to add google_project_id and google_service_account as metadata. In order to do that you have to create service account and copy the contents of the json file to value area.</p>

<p><img src="https://cdn-images-1.medium.com/max/6720/1*Ct237GU3VhYDNW4gaxaqXQ.png" alt="" /></p>

<p>We are going to create:</p>

<ul>
<li><p>a service</p></li>

<li><p>a destination rule</p></li>

<li><p>a gateway</p></li>

<li><p>a virtual service</p></li>
</ul>

<p>Create a service as given below:</p>

<p><img src="https://cdn-images-1.medium.com/max/6720/1*C56YXx3aVshqZE-7dLV8gg.png" alt="" /></p>

<p>Create a destination rule as given below:</p>

<p><img src="https://cdn-images-1.medium.com/max/6720/1*fkLMgugQdaFL3D-Z2Otw-A.png" alt="" /></p>

<p>Create a gateway as seen below. Please note that you need to use another hostname from a domain that you own. The “Secured Host” will be used for registering to DNS and to Let’s Encrypt. There can be only one Secured Host per port due to TCP protocol limitations. The default port for HTTPS is 443.</p>

<p><img src="https://cdn-images-1.medium.com/max/6720/1*-uEvOJ5PgWtiP_vzp62u3w.png" alt="" /></p>

<p>Create a virtual service as given below, here the protocol is http, the SSL/TLS termination is happening at the edge of the cluster and internal services can continue using http.</p>

<p><img src="https://cdn-images-1.medium.com/max/6720/1*uEcLnNlfbiu-2zcv7-qtgA.png" alt="" /></p>

<p>You may need to wait to get a notification that the gateway has been updated in the UI. You can view the “Gateway Details” page to see the list of current name servers:</p>

<p><img src="https://cdn-images-1.medium.com/max/6720/1*j6C-hKQrkkPi6ZL6Eh9Gwg.png" alt="" /></p>

<p>if everything went well, you can check the website on your browser:</p>

<p><img src="https://cdn-images-1.medium.com/max/5148/1*bvRbHrMS1F0LUdJ40XRD-Q.png" alt="Certificate is visible on a browser" /><em>Certificate is visible on a browser</em></p>

<p><strong>What happened?</strong></p>

<p>When a secure host is defined, Vamp Lamia first sets up a gateway and gets a public ip and then tries to communicate with your dns provider and sets up an A Record, so that your service is reachable by the ip address. Finally, Vamp Lamia is ready to set up certificates.</p>

<p>Vamp Lamia will generate certificates, authenticate with Let’s Encrypt using DNS Challenge and set it up using your DNS provider. The result of this process is also visible on Google DNS page as seen below:</p>

<p><img src="https://cdn-images-1.medium.com/max/4240/1*EgV3LkBL14OzSi-86Q0lfQ.png" alt="DNS Records after the Let’s Encrypt authorisation" /><em>DNS Records after the Let’s Encrypt authorisation</em></p>

<p>When a client asks certificate registration, Let’s Encrypt asks to authorise for that domain. There are two possible ways, an HTTP challenge and a DNS Challenge. We are using DNS challenge since it is more flexible. Let’s Encrypt gave a digest hash and we inserted a TXT record under <em>_acme-challenge.shop.democluster.net.</em></p>

<p>Finally, Vamp Lamia inserts the certificates into the Istio Gateway.</p>

<p>Please note that, Vamp Lamia makes some assumptions regarding hostnames, When you have a service hostname like service-name.domain-name.com. We assume that domain-name.com will be used as your zone name. We currently create a certificate per hostname, but we are planning to add domain-wise certificates in a later release.</p>

<p>With the current state of internet, it is crucial to have SSL/TLS certificates. As we mentioned, since Google and many other software providers are pushing for HTTPS as default in browsers, it is vital to have secure services. With this feature, in a Vamp Lamia managed cluster, it is very easy to set up a secure service and expose it to the real world.</p>

<p>See you in the next post and check our <a href="https://github.com/magneticio/vamp2setup">github</a>.</p>
        </div>

        <section class="top-banner-cta">
	<div class="top-banner-cta-body">
		<div class="top-banner-cta-body-left">
			<h3 class="top-banner-cta-title">Becoming the Frontrunner Organization</h3>
			<p class="top-banner-cta-text">A 3-step framework to simpler release management for enterprise cloud</p>
			<a class="top-banner-cta-link" href="https://pages.convertkit.com/a980d590e6/cb709441f4?utm_source=blog&utm_campaign=whitepaper&utm_content=securing-ingress-services-in-istio-with-let-s-encrypt-on-kubernetes" target="_blank">
				Download whitepaper →
			</a>
		</div>
		<div class="top-banner-cta-body-right">
			<a class="top-banner-cta-link" href="https://pages.convertkit.com/a980d590e6/cb709441f4?utm_source=blog&utm_medium=blog&utm_campaign=whitepaper&utm_content=securing-ingress-services-in-istio-with-let-s-encrypt-on-kubernetes" target="_blank">
				<img class="top-banner-cta-image" src="https://vamp.io/img/marketing/whitepaper/frontrunner_cover_720.png" alt="vamp.io whitepaper">
			</a>
		</div>
	</div>
</section>



        
<div class="addthis_inline_share_toolbox"></div>


      </div>
    </div>
  </div>
</div>

<div class="lander-row lander-row--blue footer">
  <div class="container">
    <div class="row">
      <div class="col-sm-3">
        <h3 class="h3">Address</h3>
        <address class="text">
          Raamgracht 8<br>
          1011 KK Amsterdam<br>
          The Netherlands<br>
          +31(0)88 555 33 99<br>
          info@vamp.io<br>
        </address>
        <div class="social-buttons mt-3">
          <div class="social-icons">
            <a href="https://twitter.com/vamp_io" target="_blank">
              <i class="fa fa-2x fa-twitter"></i>
            </a>
            <a href="https://www.linkedin.com/company/magnetic-io" target="_blank">
              <i class="fa fa-2x fa-linkedin"></i>
            </a>
          </div>
        </div>
      </div>
      <div class="col-sm-3">
        <h3 class="h3">Learn more</h3>
        <a href="https://vamp.io/product/">
          <p class="text">Product</p>
        </a>
        <a href="https://vamp.io/documentation/">
          <p class="text">Documentation</p>
        </a>
        <a href="https://blog.vamp.io" target="_blank">
          <p class="text">Blog</p>
        </a>
        <a href="https://vamp.io/about/">
          <p class="text">About us</p>
        </a>
        <a href="https://vamp.io/careers/">
          <p class="text">Careers
            <span class="badge d-inline ml-2">we are hiring!</span>
          </p>
        </a>
        <a href="https://vamp.io/about/contact/">
          <p class="text">Contact</p>
        </a>
        <a href="https://vamp.io/news/">
          <p class="text">News</p>
        </a>
      </div>
        <div class="col-sm-3">
        <h3 class="h3">All things code</h3>
          <a href="https://vamp.io/documentation/installation/">
            <p class="text">Installation</p>
          </a>
          <a href="https://vamp.io/documentation/api/api-reference/">
            <p class="text">API docs</p>
          </a>
          <a href="https://vamp.io/support/">
            <p class="text">Support</p>
          </a>
          <a href="https://github.com/magneticio/vamp" target="_blank">
            <p class="text">GitHub</p>
          </a>
          <a href="https://gitter.im/magneticio/vamp" target="_blank">
            <p class="text">Gitter</p>
          </a>
      </div>
      <div class="col-sm-3">
        <h3 class="h3">Stay up to date</h3>
        <p class="text">
          Leave your email for the latest news: We won’t spam you and won’t go off topic.
        </p>

        <form action="//magnetic.us9.list-manage.com/subscribe/post?u=c709b3ab8cce9e00d617e01b6&id=c1465e21d0&" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate form-inline" style="display: inline" target="_blank" novalidate="">
          <div class="input-group">
            <input type="email" name="EMAIL" id="mce-EMAIL" placeholder="Email">
            <a onclick="$(this).closest('form').submit()" class="button button--red not-active">
              <div class="button__icon button__icon--mail">
              </div>
            </a>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
<div class="footer-bottom lander-row--blue">
  <div class="container">
    <div class="part">
    </div>
    <div class="part">
      <img class="vamp-bat" src="https://vamp.io/img/003-Small-icons/Medium-blue/VAMP-Medium.svg" alt="">
      <p class="text">© 2019 <a href="https://vamp.io/about/">vamp.io</a></p>
    </div>
  </div>
</div>

<script src="//unpkg.com/vue@latest/dist/vue.min.js"></script>
<script src="//unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.min.js"></script>

<script src="https://vamp.io/js/dist/vendor.min-16301782.js" ></script>
<script src="https://vamp.io/js/dist/index.min-edd0077d.js" ></script>
<script src="https://vamp.io/js/dist/apps.min-03c09287.js" ></script>


<script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
<script type="text/javascript"> docsearch({
  apiKey: '6336564d11d0f76c3ef2521947b97f54',
  indexName: 'vamp',
  inputSelector: '.search-input',
  debug: false 
});
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>


<script>
  if (location.host === 'www.vamp.io' || location.host === 'vamp.io') {

    (function (h, o, t, j, a, r) {
      h.hj = h.hj || function () {
        (h.hj.q = h.hj.q || []).push(arguments)
      };
      h._hjSettings = {hjid: 637837, hjsv: 5};
      a = o.getElementsByTagName('head')[0];
      r = o.createElement('script');
      r.async = 1;
      r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
      a.appendChild(r);
    })(window, document, '//static.hotjar.com/c/hotjar-', '.js?sv=');
  }
</script>















<script>
  if (location.host === 'www.vamp.io' || location.host === 'vamp.io' || location.host === 'staging.vamp.io') {
    !function () {
      var t = window.driftt = window.drift = window.driftt || [];
      if (!t.init) {
        if (t.invoked) return void (window.console && console.error && console.error("Drift snippet included twice."));
        t.invoked = !0, t.methods = ["identify", "config", "track", "reset", "debug", "show", "ping", "page", "hide", "off", "on"],
          t.factory = function (e) {
            return function () {
              var n = Array.prototype.slice.call(arguments);
              return n.unshift(e), t.push(n), t;
            };
          }, t.methods.forEach(function (e) {
          t[e] = t.factory(e);
        }), t.load = function (t) {
          var e = 3e5, n = Math.ceil(new Date() / e) * e, o = document.createElement("script");
          o.type = "text/javascript", o.async = !0, o.crossorigin = "anonymous", o.src = "https://js.driftt.com/include/" + n + "/" + t + ".js";
          var i = document.getElementsByTagName("script")[0];
          i.parentNode.insertBefore(o, i);
        };
      }
    }();
    drift.SNIPPET_VERSION = '0.3.1';
    drift.load('y5f3mtg4w6nd');
  }
</script>





<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5b3cc10130bbdb11"></script>

<div class="modal fade" id="contactFormModal" tabindex="-1" role="dialog" aria-labelledby="contactFormModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-body" style="height: 875px !important;">
        <div class="float-right">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="position: absolute; right: 18px; z-index: 9999;">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="pipedriveWebForms" data-pd-webforms="https://pipedrivewebforms.com/form/ab3a32ec0da50b308a450ed88036c076810301"></div>
      </div>
    </div>
  </div>
</div>


<script src="https://unpkg.com/@tryghost/content-api@1.2.5/umd/content-api.min.js"></script>

